import{a as T,b as se}from"./chunk-T3VNKMFZ.js";import{a as O,b as ee,c as te}from"./chunk-K4MGGVBQ.js";import{a as ce,b as K}from"./chunk-URQKBNG2.js";import"./chunk-USJPHQKU.js";import"./chunk-JLH2EYJI.js";import{E as L,F as ae,b as w,f as l,g as J,i as le,k as Z,l as re,n as b}from"./chunk-NCQMUVAP.js";var B=w(T());var N=w(T()),W=b(({state:t,filter:o,handleCheckboxInputChanged:i})=>{let{fetchIsFinished:c}=t,{title:n,stateKey:d}=o,m=t[d];return l` <div class="collection-collapse-block">
      <div class="collection-collapse-block-content">
        <h3 class="collapse-block-title">${n}</h3>
        <div class="collection-sidebar-filter mt-4">
          <div
            class="form-control custom-checkbox collection-filter-checkbox first-level"
          >
            <input
              type="checkbox"
              @change=${h=>i(o,h)}
              id=${(0,N.default)(d,{lower:!0})}
              ?checked=${m}
              ?disabled=${!c}
            />
            <label
              class="form-control-label"
              for=${(0,N.default)(d,{lower:!0})}
              >${n}</label
            >
          </div>
        </div>
      </div>
    </div>`}),M=W;var k=w(T()),j=b(({state:t,filter:o,handleFirstLevelSelectedOptionsChanged:i,handleSecondLevelSelectedOptionsChanged:c})=>{let{fetchIsFinished:n,searchString:d}=t,{title:m,info:h,stateKey:p}=o,s=t[p];return l` <div
      class=${`collection-collapse-block ${o.stateKey}-nested-filter`}
    >
      <h3 class="collapse-block-title">${m}</h3>
      <div class="collection-collapse-block-content">
        <div class="collection-sidebar-filter mt-4">
          <ul class="sidebar_filter_cls first_level_options">
            ${h.map(([e,r])=>l`
                <li>
                  <div
                    class="form-control custom-checkbox collection-filter-checkbox first-level"
                  >
                    <input
                      ?disabled=${!n||d}
                      type="checkbox"
                      class="form-control-input"
                      id=${(0,k.default)(e,{lower:!0})}
                      ?checked=${!!s?.find(([a])=>a===e)}
                      @change=${a=>i(e,o,a)}
                    />
                    <label
                      class="form-control-label"
                      for=${(0,k.default)(e,{lower:!0})}
                      >${e}</label
                    >
                    <ul
                      class="sidebar_filter_cls second_level_options${s?.find(([a])=>a===e)?"":" hidden"}"
                    >
                      ${r.map(a=>{let y=`${(0,k.default)(e,{lower:!0})}-${(0,k.default)(a,{lower:!0})}`;return l`
                          <li>
                            <div
                              class="form-control custom-checkbox collection-filter-checkbox ml-3"
                            >
                              <input
                                ?disabled=${!n}
                                type="checkbox"
                                class="custom-checkbox collection-filter-checkbox"
                                id=${y}
                                ?checked=${!!s.find(([v])=>v===e)?.[1]?.includes(a)}
                                @change=${v=>c(e,a,o,v)}
                              />
                              <label class="form-control-label" for=${y}
                                >${a}</label
                              >
                            </div>
                          </li>
                        `})}
                    </ul>
                  </div>
                </li>
              `)}
          </ul>
        </div>
      </div>
    </div>`}),_=j;var x=w(T()),G=b(({state:t,filter:o,handleValueUpdated:i})=>{let{title:c,info:[n,d],stateKey:m}=o,[h,p]=t[m];return l`<div class="collection-collapse-block">
    <h3 class="collapse-block-title">${c}</h3>
    <div class="collection-collapse-block-content">
      <div
        class="collection-range-slider-wrapper ${(0,x.default)(c,{lower:!0})}-range-slider-wrapper collection-sidebar-filter mt-4"
      >
        <paper-range-slider
          id=${`${(0,x.default)(c,{lower:!0})}-range-slider`}
          min=${n}
          max=${d}
          value-min=${h}
          value-max=${p}
          @updateValues=${s=>i(o,s)}
        ></paper-range-slider>
        <style>
          .${(0,x.default)(c,{lower:!0})}-range-slider-wrapper
            > paper-range-slider:before {
            content: '${h}';
          }
          .${(0,x.default)(c,{lower:!0})}-range-slider-wrapper
            > paper-range-slider:after {
            content: '${p}';
          }
        </style>
      </div>
    </div>
  </div>`}),V=G;var H=b(({state:t,filter:o,handleSearchStringChanged:i})=>{console.log("state",t);let{searchString:c,fetchIsFinished:n}=t;return l`<input
      type="text"
      ?disabled=${!n}
      class="form-control my-3"
      id="collection-search-input"
      placeholder="Search"
      value=${c}
      @keyup=${d=>i(o,d)}
    />`}),A=H;var C=w(T()),Q=b(({state:t,filter:o,handleSelectedOptionsChanged:i})=>{let{fetchIsFinished:c,searchString:n}=t,{info:d,title:m,stateKey:h}=o,p=t[h];return l` <div class="collection-collapse-block">
      <h3 class="collapse-block-title">${m}</h3>
      <div class="collection-collapse-block-content">
        <div class="collection-sidebar-filter mt-4">
          <ul
            class="sidebar_filter_cls"
            id=${(0,C.default)(m,{lower:!0})}
          >
            ${d.map(s=>l`
                <li>
                  <div
                    class="form-control custom-checkbox collection-filter-checkbox first-level"
                  >
                    <input
                      ?disabled=${!c||n}
                      type="checkbox"
                      class="form-control-input"
                      id=${(0,C.default)(s,{lower:!0})}
                      ?checked=${!!p?.includes(s)}
                      @change=${e=>i(s,o,e)}
                    />
                    <label
                      class="form-control-label"
                      for=${(0,C.default)(s,{lower:!0})}
                      >${s}</label
                    >
                  </div>
                </li>
              `)}
          </ul>
        </div>
      </div>
    </div>`}),R=Q;var X=b(({collectionImages:t})=>l`<div class="collection-images-wrapper">
    ${t.map(o=>l`
      <div class="collection-image-wrapper py-2" style="width: 100%; min-height: 100px;">
        <a href=${o.imageTarget}
          ><img class="w-100" src=${o.imageUrl} alt=${o.imageText}
        /></a>
      </div></div>
    `)}
  </div>`),D=X;function Y(){let{state:t,dispatch:o,arrayOfFilters:i,collectionImages:c}=K(),n=(e,r)=>{o({type:e.actionType,payload:r.target.value})},d=(e,r,a)=>{a.target.checked?o({type:r.actionType,payload:[...t[r.stateKey],e]}):o({type:r.actionType,payload:t[r.stateKey].filter(v=>v!==e)})},m=(e,r,a)=>{let y=a.target;y.checked?o({type:r.actionType,payload:[...t[r.stateKey],[e,[]]]}):(o({type:r.actionType,payload:t[r.stateKey].filter(([u])=>u!==e)}),y.parentNode.querySelectorAll("ul li input").forEach(u=>{u.checked=!1}))},h=(e,r,a,y)=>{y.target.checked?o({type:a.actionType,payload:t[a.stateKey].map(([u,g])=>u===e?[u,[...g,r]]:[u,g])}):o({type:a.actionType,payload:t[a.stateKey].map(([u,g])=>u===e?[u,g.filter(S=>S!==r)]:[u,g])})},p=(e,r)=>{o({type:e.actionType,payload:[r.target.valueMin,r.target.valueMax]})},s=(e,r)=>{o({type:e.actionType,payload:r.target.checked})};return l`<div class="coll_sidebar">
    ${D({collectionImages:c})}
    ${i.find(e=>e.type==="SearchInput")?l`
          ${A({state:t,filter:i.find(e=>e.type==="SearchInput"),handleSearchStringChanged:n})}
        `:null}
    <div class="collection-filter-block custom_filter mt-4">
      ${i.map(e=>{switch(e.type){case"SimpleFilter":return l`${R({state:t,filter:e,handleSelectedOptionsChanged:d})}`;case"Checkbox":return l`${M({state:t,filter:e,handleCheckboxInputChanged:s})}`;case"NestedFilter":return l`${_({state:t,filter:e,handleFirstLevelSelectedOptionsChanged:m,handleSecondLevelSelectedOptionsChanged:h})}`;case"RangeSlider":return l`${V({state:t,filter:e,handleValueUpdated:p})}`;default:return null}})}
    </div>
  </div>`}var E={tagName:"product-type-sidebar",renderer:Y,options:{observedAttributes:[],useShadowDOM:!1}};function oe(){let{collectionTitle:t,emptyCollectionImage:o,getFilteredSortedProducts:i,getFilteredSortedProductsOfCurrentPage:c,getPageCount:n,getDisplayedPageNumbers:d,productsOfFirstPage:m,state:h,dispatch:p}=K(),{fetchIsFinished:s,viewMode:e,sortValue:r,productsPerPage:a,pageNumber:y}=h,u=i().length,g=[];s?g=c():g=m??[];let S=n(),F=d(),f=Z(this),P=$=>{p({type:"changeViewMode",payload:$})},I=$=>{p({type:"changeProductsPerPage",payload:Number($.target.value)})},U=$=>{p({type:"changeSortValue",payload:$.target.value})},z=$=>{Number.isNaN(Number($))||p({type:"changePageNumber",payload:$})};return l`${L({title:t})}${ee({fetchIsFinished:s,productsSize:u,viewMode:e,productsPerPage:a,sortValue:r,handleViewModeIconClicked:P,handleProductsPerPageChanged:I,handleSortValueChanged:U})}${te({mainContentElement:f.current,productsOfCurrentPage:g,viewMode:e,emptyCollectionImage:o})}${O({fetchIsFinished:s,pageNumber:y,displayedPageNumbers:F,pageCount:S,handlePageLinkClicked:z})}`}var q={tagName:"product-type-main-content",renderer:oe,options:{observedAttributes:[],useShadowDOM:!1}};function ie({productType:t,allFilters:o,defaultSortBy:i,collectionTitle:c,collectionMetafield:n,emptyCollectionImage:d}){let m=JSON.parse(o).map(f=>{let{selected:P,...I}=f;return I}).filter(f=>f.stateKey),h=JSON.parse(o).reduce((f,P)=>(f[P.stateKey]=P.selected,f),{}),p=JSON.parse(n??"{}")?.images??[],{state:s,dispatch:e,queryAllProducts:r,queryFirstPageProducts:a,getFilteredSortedProducts:y,getFilteredSortedProductsOfCurrentPage:v,getPageCount:u,getDisplayedPageNumbers:g}=new(se((0,B.default)(t,{lower:!0})))({defaultSortBy:i,initialValueFilterKeyPairs:h}),[S,F]=le([]);return J(async()=>{let f=await a();F(f)},[]),J(async()=>{let f=await r();console.log("products from queryAllProducts",f),e({type:"setAllProducts",payload:f}),e({type:"setFetchIsFinished",payload:!0})},[]),l`${ce({children:l` <section class="section-b-space">
      <div class="collection-wrapper">
        <div class="container">
          <div class="row">
            <product-type-sidebar
              class="collection-filter col-sm-3"
            ></product-type-sidebar>
            <div class="collection-content col">
              <div class="page-main-content">
                <div class="container-fluid">
                  <div class="row">
                    <div class="col-sm-12">
                      <product-type-main-content></product-type-main-content>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>`,productType:t,productsOfFirstPage:S,collectionImages:p,collectionTitle:c,arrayOfFilters:m,emptyCollectionImage:d,getFilteredSortedProducts:y,getFilteredSortedProductsOfCurrentPage:v,getPageCount:u,getDisplayedPageNumbers:g,state:s,dispatch:e})}`}[E,q,ae,{tagName:"product-type-collection",renderer:ie,options:{observedAttributes:["product-type","all-filters","default-sort-by","collection-title","collection-metafield","empty-collection-image"],useShadowDOM:!1}}].forEach(t=>{customElements.define(t.tagName,re(t.renderer,t.options))});
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vc3JjL3BhZ2VzL1Byb2R1Y3RUeXBlQ29sbGVjdGlvbi5qcyIsICIuLi9zcmMvY29tcG9uZW50cy9wcm9kdWN0VHlwZUNvbGxlY3Rpb24vU2lkZWJhckNoZWNrYm94LmpzIiwgIi4uL3NyYy9jb21wb25lbnRzL3Byb2R1Y3RUeXBlQ29sbGVjdGlvbi9TaWRlYmFyTmVzdGVkRmlsdGVyLmpzIiwgIi4uL3NyYy9jb21wb25lbnRzL3Byb2R1Y3RUeXBlQ29sbGVjdGlvbi9TaWRlYmFyUmFuZ2VTbGlkZXIuanMiLCAiLi4vc3JjL2NvbXBvbmVudHMvcHJvZHVjdFR5cGVDb2xsZWN0aW9uL1NpZGViYXJTZWFyY2hJbnB1dC5qcyIsICIuLi9zcmMvY29tcG9uZW50cy9wcm9kdWN0VHlwZUNvbGxlY3Rpb24vU2lkZWJhclNpbXBsZUZJbHRlci5qcyIsICIuLi9zcmMvY29tcG9uZW50cy9wcm9kdWN0VHlwZUNvbGxlY3Rpb24vU2lkZWJhclRvcEltYWdlcy5qcyIsICIuLi9zcmMvY29tcG9uZW50cy9wcm9kdWN0VHlwZUNvbGxlY3Rpb24vUHJvZHVjdFR5cGVTaWRlYmFyLmpzIiwgIi4uL3NyYy9jb21wb25lbnRzL3Byb2R1Y3RUeXBlQ29sbGVjdGlvbi9Qcm9kdWN0VHlwZU1haW5Db250ZW50LmpzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBodG1sLCB1c2VFZmZlY3QsIHVzZVN0YXRlLCBjb21wb25lbnQgfSBmcm9tICdAYXBvbGxvLWVsZW1lbnRzL2hhdW50ZWQnO1xuaW1wb3J0IHNsdWdpZnkgZnJvbSAnc2x1Z2lmeSc7XG5pbXBvcnQgeyBDb21wYXJlVGFibGUgfSBmcm9tICcuLi9zaGFyZWQvaW5kZXgnO1xuaW1wb3J0IHsgcGFnZVdyYXBwZXIgfSBmcm9tICcuLi9zaGFyZWQvY29udGV4dCc7XG5pbXBvcnQgdXNlUHJvZHVjdFR5cGUgZnJvbSAnLi4vcHJvZHVjdFR5cGVzJztcbmltcG9ydCBQcm9kdWN0VHlwZVNpZGViYXIgZnJvbSAnLi4vY29tcG9uZW50cy9wcm9kdWN0VHlwZUNvbGxlY3Rpb24vUHJvZHVjdFR5cGVTaWRlYmFyJztcbmltcG9ydCBQcm9kdWN0VHlwZU1haW5Db250ZW50IGZyb20gJy4uL2NvbXBvbmVudHMvcHJvZHVjdFR5cGVDb2xsZWN0aW9uL1Byb2R1Y3RUeXBlTWFpbkNvbnRlbnQnO1xuXG5mdW5jdGlvbiBQcm9kdWN0VHlwZUNvbGxlY3Rpb24oe1xuICBwcm9kdWN0VHlwZSxcbiAgYWxsRmlsdGVycyxcbiAgZGVmYXVsdFNvcnRCeSxcbiAgY29sbGVjdGlvblRpdGxlLFxuICBjb2xsZWN0aW9uTWV0YWZpZWxkLFxuICBlbXB0eUNvbGxlY3Rpb25JbWFnZSxcbn0pIHtcbiAgY29uc3QgYXJyYXlPZkZpbHRlcnMgPSBKU09OLnBhcnNlKGFsbEZpbHRlcnMpXG4gICAgLm1hcCgoZmlsdGVyKSA9PiB7XG4gICAgICBjb25zdCB7IHNlbGVjdGVkLCAuLi5yZXN0IH0gPSBmaWx0ZXI7XG4gICAgICByZXR1cm4gcmVzdDtcbiAgICB9KVxuICAgIC5maWx0ZXIoKGZpbHRlcikgPT4gZmlsdGVyLnN0YXRlS2V5KTtcbiAgY29uc3QgaW5pdGlhbFZhbHVlRmlsdGVyS2V5UGFpcnMgPSBKU09OLnBhcnNlKGFsbEZpbHRlcnMpLnJlZHVjZShcbiAgICAoYWNjLCBjdXIpID0+IHtcbiAgICAgIGFjY1tjdXIuc3RhdGVLZXldID0gY3VyLnNlbGVjdGVkO1xuICAgICAgcmV0dXJuIGFjYztcbiAgICB9LFxuICAgIHt9XG4gICk7XG5cbiAgY29uc3QgY29sbGVjdGlvbkltYWdlcyA9XG4gICAgSlNPTi5wYXJzZShjb2xsZWN0aW9uTWV0YWZpZWxkID8/ICd7fScpPy5pbWFnZXMgPz8gW107XG5cbiAgY29uc3Qge1xuICAgIHN0YXRlLFxuICAgIGRpc3BhdGNoLFxuICAgIHF1ZXJ5QWxsUHJvZHVjdHMsXG4gICAgcXVlcnlGaXJzdFBhZ2VQcm9kdWN0cyxcbiAgICBnZXRGaWx0ZXJlZFNvcnRlZFByb2R1Y3RzLFxuICAgIGdldEZpbHRlcmVkU29ydGVkUHJvZHVjdHNPZkN1cnJlbnRQYWdlLFxuICAgIGdldFBhZ2VDb3VudCxcbiAgICBnZXREaXNwbGF5ZWRQYWdlTnVtYmVycyxcbiAgfSA9IG5ldyAodXNlUHJvZHVjdFR5cGUoc2x1Z2lmeShwcm9kdWN0VHlwZSwgeyBsb3dlcjogdHJ1ZSB9KSkpKHtcbiAgICBkZWZhdWx0U29ydEJ5LFxuICAgIGluaXRpYWxWYWx1ZUZpbHRlcktleVBhaXJzLFxuICB9KTtcblxuICBjb25zdCBbcHJvZHVjdHNPZkZpcnN0UGFnZSwgc2V0UHJvZHVjdHNPZkZpcnN0UGFnZV0gPSB1c2VTdGF0ZShbXSk7XG5cbiAgdXNlRWZmZWN0KGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBwcm9kdWN0cyA9IGF3YWl0IHF1ZXJ5Rmlyc3RQYWdlUHJvZHVjdHMoKTtcbiAgICBzZXRQcm9kdWN0c09mRmlyc3RQYWdlKHByb2R1Y3RzKTtcbiAgfSwgW10pO1xuXG4gIHVzZUVmZmVjdChhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBxdWVyeUFsbFByb2R1Y3RzKCk7XG4gICAgY29uc29sZS5sb2coJ3Byb2R1Y3RzIGZyb20gcXVlcnlBbGxQcm9kdWN0cycsIHByb2R1Y3RzKTtcbiAgICBkaXNwYXRjaCh7IHR5cGU6ICdzZXRBbGxQcm9kdWN0cycsIHBheWxvYWQ6IHByb2R1Y3RzIH0pO1xuICAgIGRpc3BhdGNoKHsgdHlwZTogJ3NldEZldGNoSXNGaW5pc2hlZCcsIHBheWxvYWQ6IHRydWUgfSk7XG4gIH0sIFtdKTtcblxuICByZXR1cm4gaHRtbGAke3BhZ2VXcmFwcGVyKHtcbiAgICBjaGlsZHJlbjogaHRtbGAgPHNlY3Rpb24gY2xhc3M9XCJzZWN0aW9uLWItc3BhY2VcIj5cbiAgICAgIDxkaXYgY2xhc3M9XCJjb2xsZWN0aW9uLXdyYXBwZXJcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImNvbnRhaW5lclwiPlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJyb3dcIj5cbiAgICAgICAgICAgIDxwcm9kdWN0LXR5cGUtc2lkZWJhclxuICAgICAgICAgICAgICBjbGFzcz1cImNvbGxlY3Rpb24tZmlsdGVyIGNvbC1zbS0zXCJcbiAgICAgICAgICAgID48L3Byb2R1Y3QtdHlwZS1zaWRlYmFyPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbGxlY3Rpb24tY29udGVudCBjb2xcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInBhZ2UtbWFpbi1jb250ZW50XCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbnRhaW5lci1mbHVpZFwiPlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInJvd1wiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29sLXNtLTEyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgPHByb2R1Y3QtdHlwZS1tYWluLWNvbnRlbnQ+PC9wcm9kdWN0LXR5cGUtbWFpbi1jb250ZW50PlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIDwvc2VjdGlvbj5gLFxuICAgIHByb2R1Y3RUeXBlLFxuICAgIHByb2R1Y3RzT2ZGaXJzdFBhZ2UsXG4gICAgY29sbGVjdGlvbkltYWdlcyxcbiAgICBjb2xsZWN0aW9uVGl0bGUsXG4gICAgYXJyYXlPZkZpbHRlcnMsXG4gICAgZW1wdHlDb2xsZWN0aW9uSW1hZ2UsXG4gICAgZ2V0RmlsdGVyZWRTb3J0ZWRQcm9kdWN0cyxcbiAgICBnZXRGaWx0ZXJlZFNvcnRlZFByb2R1Y3RzT2ZDdXJyZW50UGFnZSxcbiAgICBnZXRQYWdlQ291bnQsXG4gICAgZ2V0RGlzcGxheWVkUGFnZU51bWJlcnMsXG4gICAgc3RhdGUsXG4gICAgZGlzcGF0Y2gsXG4gIH0pfWA7XG59XG5cbltcbiAgUHJvZHVjdFR5cGVTaWRlYmFyLFxuICBQcm9kdWN0VHlwZU1haW5Db250ZW50LFxuICBDb21wYXJlVGFibGUsXG4gIHtcbiAgICB0YWdOYW1lOiAncHJvZHVjdC10eXBlLWNvbGxlY3Rpb24nLFxuICAgIHJlbmRlcmVyOiBQcm9kdWN0VHlwZUNvbGxlY3Rpb24sXG4gICAgb3B0aW9uczoge1xuICAgICAgb2JzZXJ2ZWRBdHRyaWJ1dGVzOiBbXG4gICAgICAgICdwcm9kdWN0LXR5cGUnLFxuICAgICAgICAnYWxsLWZpbHRlcnMnLFxuICAgICAgICAnZGVmYXVsdC1zb3J0LWJ5JyxcbiAgICAgICAgJ2NvbGxlY3Rpb24tdGl0bGUnLFxuICAgICAgICAnY29sbGVjdGlvbi1tZXRhZmllbGQnLFxuICAgICAgICAnZW1wdHktY29sbGVjdGlvbi1pbWFnZScsXG4gICAgICBdLFxuICAgICAgdXNlU2hhZG93RE9NOiBmYWxzZSxcbiAgICB9LFxuICB9LFxuXS5mb3JFYWNoKChwQ29tcG9uZW50KSA9PiB7XG4gIGN1c3RvbUVsZW1lbnRzLmRlZmluZShcbiAgICBwQ29tcG9uZW50LnRhZ05hbWUsXG4gICAgY29tcG9uZW50KHBDb21wb25lbnQucmVuZGVyZXIsIHBDb21wb25lbnQub3B0aW9ucylcbiAgKTtcbn0pO1xuIiwgImltcG9ydCB7IGh0bWwsIHZpcnR1YWwgfSBmcm9tICdAYXBvbGxvLWVsZW1lbnRzL2hhdW50ZWQnO1xuaW1wb3J0IHNsdWdpZnkgZnJvbSAnc2x1Z2lmeSc7XG5cbmNvbnN0IFNpZGViYXJDaGVja2JveCA9IHZpcnR1YWwoXG4gICh7IHN0YXRlLCBmaWx0ZXIsIGhhbmRsZUNoZWNrYm94SW5wdXRDaGFuZ2VkIH0pID0+IHtcbiAgICBjb25zdCB7IGZldGNoSXNGaW5pc2hlZCB9ID0gc3RhdGU7XG4gICAgY29uc3QgeyB0aXRsZTogZmlsdGVyVGl0bGUsIHN0YXRlS2V5IH0gPSBmaWx0ZXI7XG4gICAgY29uc3QgY2hlY2tlZCA9IHN0YXRlW3N0YXRlS2V5XTtcbiAgICByZXR1cm4gaHRtbGAgPGRpdiBjbGFzcz1cImNvbGxlY3Rpb24tY29sbGFwc2UtYmxvY2tcIj5cbiAgICAgIDxkaXYgY2xhc3M9XCJjb2xsZWN0aW9uLWNvbGxhcHNlLWJsb2NrLWNvbnRlbnRcIj5cbiAgICAgICAgPGgzIGNsYXNzPVwiY29sbGFwc2UtYmxvY2stdGl0bGVcIj4ke2ZpbHRlclRpdGxlfTwvaDM+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJjb2xsZWN0aW9uLXNpZGViYXItZmlsdGVyIG10LTRcIj5cbiAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICBjbGFzcz1cImZvcm0tY29udHJvbCBjdXN0b20tY2hlY2tib3ggY29sbGVjdGlvbi1maWx0ZXItY2hlY2tib3ggZmlyc3QtbGV2ZWxcIlxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICB0eXBlPVwiY2hlY2tib3hcIlxuICAgICAgICAgICAgICBAY2hhbmdlPSR7KGUpID0+IGhhbmRsZUNoZWNrYm94SW5wdXRDaGFuZ2VkKGZpbHRlciwgZSl9XG4gICAgICAgICAgICAgIGlkPSR7c2x1Z2lmeShzdGF0ZUtleSwgeyBsb3dlcjogdHJ1ZSB9KX1cbiAgICAgICAgICAgICAgP2NoZWNrZWQ9JHtjaGVja2VkfVxuICAgICAgICAgICAgICA/ZGlzYWJsZWQ9JHshZmV0Y2hJc0ZpbmlzaGVkfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDxsYWJlbFxuICAgICAgICAgICAgICBjbGFzcz1cImZvcm0tY29udHJvbC1sYWJlbFwiXG4gICAgICAgICAgICAgIGZvcj0ke3NsdWdpZnkoc3RhdGVLZXksIHsgbG93ZXI6IHRydWUgfSl9XG4gICAgICAgICAgICAgID4ke2ZpbHRlclRpdGxlfTwvbGFiZWxcbiAgICAgICAgICAgID5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5gO1xuICB9XG4pO1xuXG5leHBvcnQgZGVmYXVsdCBTaWRlYmFyQ2hlY2tib3g7XG4iLCAiaW1wb3J0IHsgaHRtbCwgdmlydHVhbCB9IGZyb20gJ0BhcG9sbG8tZWxlbWVudHMvaGF1bnRlZCc7XG5pbXBvcnQgc2x1Z2lmeSBmcm9tICdzbHVnaWZ5JztcblxuY29uc3QgU2lkZWJhck5lc3RlZEZpbHRlciA9IHZpcnR1YWwoXG4gICh7XG4gICAgc3RhdGUsXG4gICAgZmlsdGVyLFxuICAgIGhhbmRsZUZpcnN0TGV2ZWxTZWxlY3RlZE9wdGlvbnNDaGFuZ2VkLFxuICAgIGhhbmRsZVNlY29uZExldmVsU2VsZWN0ZWRPcHRpb25zQ2hhbmdlZCxcbiAgfSkgPT4ge1xuICAgIGNvbnN0IHsgZmV0Y2hJc0ZpbmlzaGVkLCBzZWFyY2hTdHJpbmcgfSA9IHN0YXRlO1xuICAgIGNvbnN0IHsgdGl0bGU6IGZpbHRlclRpdGxlLCBpbmZvOiBvcHRpb25zLCBzdGF0ZUtleSB9ID0gZmlsdGVyO1xuICAgIGNvbnN0IHNlbGVjdGVkT3B0aW9ucyA9IHN0YXRlW3N0YXRlS2V5XTtcbiAgICByZXR1cm4gaHRtbGAgPGRpdlxuICAgICAgY2xhc3M9JHtgY29sbGVjdGlvbi1jb2xsYXBzZS1ibG9jayAke2ZpbHRlci5zdGF0ZUtleX0tbmVzdGVkLWZpbHRlcmB9XG4gICAgPlxuICAgICAgPGgzIGNsYXNzPVwiY29sbGFwc2UtYmxvY2stdGl0bGVcIj4ke2ZpbHRlclRpdGxlfTwvaDM+XG4gICAgICA8ZGl2IGNsYXNzPVwiY29sbGVjdGlvbi1jb2xsYXBzZS1ibG9jay1jb250ZW50XCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJjb2xsZWN0aW9uLXNpZGViYXItZmlsdGVyIG10LTRcIj5cbiAgICAgICAgICA8dWwgY2xhc3M9XCJzaWRlYmFyX2ZpbHRlcl9jbHMgZmlyc3RfbGV2ZWxfb3B0aW9uc1wiPlxuICAgICAgICAgICAgJHtvcHRpb25zLm1hcChcbiAgICAgICAgICAgICAgKFtmaXJzdExldmVsT3B0aW9uLCBzZWNvbmRMZXZlbE9wdGlvbnNdKSA9PiBodG1sYFxuICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgY2xhc3M9XCJmb3JtLWNvbnRyb2wgY3VzdG9tLWNoZWNrYm94IGNvbGxlY3Rpb24tZmlsdGVyLWNoZWNrYm94IGZpcnN0LWxldmVsXCJcbiAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgICAgICAgP2Rpc2FibGVkPSR7IWZldGNoSXNGaW5pc2hlZCB8fCBzZWFyY2hTdHJpbmd9XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZT1cImNoZWNrYm94XCJcbiAgICAgICAgICAgICAgICAgICAgICBjbGFzcz1cImZvcm0tY29udHJvbC1pbnB1dFwiXG4gICAgICAgICAgICAgICAgICAgICAgaWQ9JHtzbHVnaWZ5KGZpcnN0TGV2ZWxPcHRpb24sIHsgbG93ZXI6IHRydWUgfSl9XG4gICAgICAgICAgICAgICAgICAgICAgP2NoZWNrZWQ9JHshIXNlbGVjdGVkT3B0aW9ucz8uZmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgIChbZm9wdGlvbl0pID0+IGZvcHRpb24gPT09IGZpcnN0TGV2ZWxPcHRpb25cbiAgICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgICAgICAgIEBjaGFuZ2U9JHsoZSkgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZUZpcnN0TGV2ZWxTZWxlY3RlZE9wdGlvbnNDaGFuZ2VkKFxuICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdExldmVsT3B0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGVcbiAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDxsYWJlbFxuICAgICAgICAgICAgICAgICAgICAgIGNsYXNzPVwiZm9ybS1jb250cm9sLWxhYmVsXCJcbiAgICAgICAgICAgICAgICAgICAgICBmb3I9JHtzbHVnaWZ5KGZpcnN0TGV2ZWxPcHRpb24sIHsgbG93ZXI6IHRydWUgfSl9XG4gICAgICAgICAgICAgICAgICAgICAgPiR7Zmlyc3RMZXZlbE9wdGlvbn08L2xhYmVsXG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgPHVsXG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3M9XCJzaWRlYmFyX2ZpbHRlcl9jbHMgc2Vjb25kX2xldmVsX29wdGlvbnMke3NlbGVjdGVkT3B0aW9ucz8uZmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgIChbZm9wdGlvbl0pID0+IGZvcHRpb24gPT09IGZpcnN0TGV2ZWxPcHRpb25cbiAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgICAgICA/ICcnXG4gICAgICAgICAgICAgICAgICAgICAgICA6ICcgaGlkZGVuJ31cIlxuICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgJHtzZWNvbmRMZXZlbE9wdGlvbnMubWFwKChzZWNvbmRMZXZlbE9wdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5wdXRJZCA9IGAke3NsdWdpZnkoZmlyc3RMZXZlbE9wdGlvbiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBsb3dlcjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pfS0ke3NsdWdpZnkoc2Vjb25kTGV2ZWxPcHRpb24sIHsgbG93ZXI6IHRydWUgfSl9YDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBodG1sYFxuICAgICAgICAgICAgICAgICAgICAgICAgICA8bGk+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M9XCJmb3JtLWNvbnRyb2wgY3VzdG9tLWNoZWNrYm94IGNvbGxlY3Rpb24tZmlsdGVyLWNoZWNrYm94IG1sLTNcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA/ZGlzYWJsZWQ9JHshZmV0Y2hJc0ZpbmlzaGVkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwiY2hlY2tib3hcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz1cImN1c3RvbS1jaGVja2JveCBjb2xsZWN0aW9uLWZpbHRlci1jaGVja2JveFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPSR7aW5wdXRJZH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgP2NoZWNrZWQ9JHshIXNlbGVjdGVkT3B0aW9uc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKFtmb3B0aW9uXSkgPT4gZm9wdGlvbiA9PT0gZmlyc3RMZXZlbE9wdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk/LlsxXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8uaW5jbHVkZXMoc2Vjb25kTGV2ZWxPcHRpb24pfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAY2hhbmdlPSR7KGUpID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlU2Vjb25kTGV2ZWxTZWxlY3RlZE9wdGlvbnNDaGFuZ2VkKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RMZXZlbE9wdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlY29uZExldmVsT3B0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxhYmVsIGNsYXNzPVwiZm9ybS1jb250cm9sLWxhYmVsXCIgZm9yPSR7aW5wdXRJZH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPiR7c2Vjb25kTGV2ZWxPcHRpb259PC9sYWJlbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgICAgICAgICAgICAgYDtcbiAgICAgICAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAgICAgICAgPC91bD5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvbGk+XG4gICAgICAgICAgICAgIGBcbiAgICAgICAgICAgICl9XG4gICAgICAgICAgPC91bD5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5gO1xuICB9XG4pO1xuXG5leHBvcnQgZGVmYXVsdCBTaWRlYmFyTmVzdGVkRmlsdGVyO1xuIiwgImltcG9ydCB7IGh0bWwsIHZpcnR1YWwgfSBmcm9tICdAYXBvbGxvLWVsZW1lbnRzL2hhdW50ZWQnO1xuaW1wb3J0IHNsdWdpZnkgZnJvbSAnc2x1Z2lmeSc7XG5cbmNvbnN0IFNpZGViYXJSYW5nZVNsaWRlciA9IHZpcnR1YWwoKHsgc3RhdGUsIGZpbHRlciwgaGFuZGxlVmFsdWVVcGRhdGVkIH0pID0+IHtcbiAgY29uc3Qge1xuICAgIHRpdGxlOiByYW5nZVRpdGxlLFxuICAgIGluZm86IFttaW4sIG1heF0sXG4gICAgc3RhdGVLZXksXG4gIH0gPSBmaWx0ZXI7XG4gIGNvbnN0IFt2YWx1ZU1pbiwgdmFsdWVNYXhdID0gc3RhdGVbc3RhdGVLZXldO1xuICByZXR1cm4gaHRtbGA8ZGl2IGNsYXNzPVwiY29sbGVjdGlvbi1jb2xsYXBzZS1ibG9ja1wiPlxuICAgIDxoMyBjbGFzcz1cImNvbGxhcHNlLWJsb2NrLXRpdGxlXCI+JHtyYW5nZVRpdGxlfTwvaDM+XG4gICAgPGRpdiBjbGFzcz1cImNvbGxlY3Rpb24tY29sbGFwc2UtYmxvY2stY29udGVudFwiPlxuICAgICAgPGRpdlxuICAgICAgICBjbGFzcz1cImNvbGxlY3Rpb24tcmFuZ2Utc2xpZGVyLXdyYXBwZXIgJHtzbHVnaWZ5KHJhbmdlVGl0bGUsIHtcbiAgICAgICAgICBsb3dlcjogdHJ1ZSxcbiAgICAgICAgfSl9LXJhbmdlLXNsaWRlci13cmFwcGVyIGNvbGxlY3Rpb24tc2lkZWJhci1maWx0ZXIgbXQtNFwiXG4gICAgICA+XG4gICAgICAgIDxwYXBlci1yYW5nZS1zbGlkZXJcbiAgICAgICAgICBpZD0ke2Ake3NsdWdpZnkocmFuZ2VUaXRsZSwge1xuICAgICAgICAgICAgbG93ZXI6IHRydWUsXG4gICAgICAgICAgfSl9LXJhbmdlLXNsaWRlcmB9XG4gICAgICAgICAgbWluPSR7bWlufVxuICAgICAgICAgIG1heD0ke21heH1cbiAgICAgICAgICB2YWx1ZS1taW49JHt2YWx1ZU1pbn1cbiAgICAgICAgICB2YWx1ZS1tYXg9JHt2YWx1ZU1heH1cbiAgICAgICAgICBAdXBkYXRlVmFsdWVzPSR7KGUpID0+IGhhbmRsZVZhbHVlVXBkYXRlZChmaWx0ZXIsIGUpfVxuICAgICAgICA+PC9wYXBlci1yYW5nZS1zbGlkZXI+XG4gICAgICAgIDxzdHlsZT5cbiAgICAgICAgICAuJHtzbHVnaWZ5KHJhbmdlVGl0bGUsIHtcbiAgICAgICAgICAgICAgbG93ZXI6IHRydWUsXG4gICAgICAgICAgICB9KX0tcmFuZ2Utc2xpZGVyLXdyYXBwZXJcbiAgICAgICAgICAgID4gcGFwZXItcmFuZ2Utc2xpZGVyOmJlZm9yZSB7XG4gICAgICAgICAgICBjb250ZW50OiAnJHt2YWx1ZU1pbn0nO1xuICAgICAgICAgIH1cbiAgICAgICAgICAuJHtzbHVnaWZ5KHJhbmdlVGl0bGUsIHtcbiAgICAgICAgICAgICAgbG93ZXI6IHRydWUsXG4gICAgICAgICAgICB9KX0tcmFuZ2Utc2xpZGVyLXdyYXBwZXJcbiAgICAgICAgICAgID4gcGFwZXItcmFuZ2Utc2xpZGVyOmFmdGVyIHtcbiAgICAgICAgICAgIGNvbnRlbnQ6ICcke3ZhbHVlTWF4fSc7XG4gICAgICAgICAgfVxuICAgICAgICA8L3N0eWxlPlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIDwvZGl2PmA7XG59KTtcblxuZXhwb3J0IGRlZmF1bHQgU2lkZWJhclJhbmdlU2xpZGVyO1xuIiwgImltcG9ydCB7IGh0bWwsIHZpcnR1YWwgfSBmcm9tICdAYXBvbGxvLWVsZW1lbnRzL2hhdW50ZWQnO1xuXG5jb25zdCBTaWRlYmFyU2VhcmNoSW5wdXQgPSB2aXJ0dWFsKFxuICAoeyBzdGF0ZSwgZmlsdGVyLCBoYW5kbGVTZWFyY2hTdHJpbmdDaGFuZ2VkIH0pID0+IHtcbiAgICBjb25zb2xlLmxvZygnc3RhdGUnLCBzdGF0ZSk7XG4gICAgY29uc3QgeyBzZWFyY2hTdHJpbmcsIGZldGNoSXNGaW5pc2hlZCB9ID0gc3RhdGU7XG4gICAgcmV0dXJuIGh0bWxgPGlucHV0XG4gICAgICB0eXBlPVwidGV4dFwiXG4gICAgICA/ZGlzYWJsZWQ9JHshZmV0Y2hJc0ZpbmlzaGVkfVxuICAgICAgY2xhc3M9XCJmb3JtLWNvbnRyb2wgbXktM1wiXG4gICAgICBpZD1cImNvbGxlY3Rpb24tc2VhcmNoLWlucHV0XCJcbiAgICAgIHBsYWNlaG9sZGVyPVwiU2VhcmNoXCJcbiAgICAgIHZhbHVlPSR7c2VhcmNoU3RyaW5nfVxuICAgICAgQGtleXVwPSR7KGUpID0+IGhhbmRsZVNlYXJjaFN0cmluZ0NoYW5nZWQoZmlsdGVyLCBlKX1cbiAgICAvPmA7XG4gIH1cbik7XG5cbmV4cG9ydCBkZWZhdWx0IFNpZGViYXJTZWFyY2hJbnB1dDtcbiIsICJpbXBvcnQgeyBodG1sLCB2aXJ0dWFsIH0gZnJvbSAnQGFwb2xsby1lbGVtZW50cy9oYXVudGVkJztcbmltcG9ydCBzbHVnaWZ5IGZyb20gJ3NsdWdpZnknO1xuXG5jb25zdCBTaWRlYmFyU2ltcGxlRmlsdGVyID0gdmlydHVhbChcbiAgKHsgc3RhdGUsIGZpbHRlciwgaGFuZGxlU2VsZWN0ZWRPcHRpb25zQ2hhbmdlZCB9KSA9PiB7XG4gICAgY29uc3QgeyBmZXRjaElzRmluaXNoZWQsIHNlYXJjaFN0cmluZyB9ID0gc3RhdGU7XG4gICAgY29uc3QgeyBpbmZvOiBvcHRpb25zLCB0aXRsZTogZmlsdGVyVGl0bGUsIHN0YXRlS2V5IH0gPSBmaWx0ZXI7XG4gICAgY29uc3Qgc2VsZWN0ZWRPcHRpb25zID0gc3RhdGVbc3RhdGVLZXldO1xuICAgIHJldHVybiBodG1sYCA8ZGl2IGNsYXNzPVwiY29sbGVjdGlvbi1jb2xsYXBzZS1ibG9ja1wiPlxuICAgICAgPGgzIGNsYXNzPVwiY29sbGFwc2UtYmxvY2stdGl0bGVcIj4ke2ZpbHRlclRpdGxlfTwvaDM+XG4gICAgICA8ZGl2IGNsYXNzPVwiY29sbGVjdGlvbi1jb2xsYXBzZS1ibG9jay1jb250ZW50XCI+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJjb2xsZWN0aW9uLXNpZGViYXItZmlsdGVyIG10LTRcIj5cbiAgICAgICAgICA8dWxcbiAgICAgICAgICAgIGNsYXNzPVwic2lkZWJhcl9maWx0ZXJfY2xzXCJcbiAgICAgICAgICAgIGlkPSR7c2x1Z2lmeShmaWx0ZXJUaXRsZSwgeyBsb3dlcjogdHJ1ZSB9KX1cbiAgICAgICAgICA+XG4gICAgICAgICAgICAke29wdGlvbnMubWFwKFxuICAgICAgICAgICAgICAob3B0aW9uKSA9PiBodG1sYFxuICAgICAgICAgICAgICAgIDxsaT5cbiAgICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgICAgY2xhc3M9XCJmb3JtLWNvbnRyb2wgY3VzdG9tLWNoZWNrYm94IGNvbGxlY3Rpb24tZmlsdGVyLWNoZWNrYm94IGZpcnN0LWxldmVsXCJcbiAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgICAgICAgP2Rpc2FibGVkPSR7IWZldGNoSXNGaW5pc2hlZCB8fCBzZWFyY2hTdHJpbmd9XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZT1cImNoZWNrYm94XCJcbiAgICAgICAgICAgICAgICAgICAgICBjbGFzcz1cImZvcm0tY29udHJvbC1pbnB1dFwiXG4gICAgICAgICAgICAgICAgICAgICAgaWQ9JHtzbHVnaWZ5KG9wdGlvbiwgeyBsb3dlcjogdHJ1ZSB9KX1cbiAgICAgICAgICAgICAgICAgICAgICA/Y2hlY2tlZD0keyEhc2VsZWN0ZWRPcHRpb25zPy5pbmNsdWRlcyhvcHRpb24pfVxuICAgICAgICAgICAgICAgICAgICAgIEBjaGFuZ2U9JHsoZSkgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZVNlbGVjdGVkT3B0aW9uc0NoYW5nZWQob3B0aW9uLCBmaWx0ZXIsIGUpfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8bGFiZWxcbiAgICAgICAgICAgICAgICAgICAgICBjbGFzcz1cImZvcm0tY29udHJvbC1sYWJlbFwiXG4gICAgICAgICAgICAgICAgICAgICAgZm9yPSR7c2x1Z2lmeShvcHRpb24sIHsgbG93ZXI6IHRydWUgfSl9XG4gICAgICAgICAgICAgICAgICAgICAgPiR7b3B0aW9ufTwvbGFiZWxcbiAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgICAgYFxuICAgICAgICAgICAgKX1cbiAgICAgICAgICA8L3VsPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PmA7XG4gIH1cbik7XG5cbmV4cG9ydCBkZWZhdWx0IFNpZGViYXJTaW1wbGVGaWx0ZXI7XG4iLCAiaW1wb3J0IHsgaHRtbCwgdmlydHVhbCB9IGZyb20gJ0BhcG9sbG8tZWxlbWVudHMvaGF1bnRlZCc7XG5cbmNvbnN0IFNpZGViYXJUb3BJbWFnZXMgPSB2aXJ0dWFsKFxuICAoeyBjb2xsZWN0aW9uSW1hZ2VzIH0pID0+IGh0bWxgPGRpdiBjbGFzcz1cImNvbGxlY3Rpb24taW1hZ2VzLXdyYXBwZXJcIj5cbiAgICAke2NvbGxlY3Rpb25JbWFnZXMubWFwKFxuICAgICAgKGltYWdlKSA9PiBodG1sYFxuICAgICAgPGRpdiBjbGFzcz1cImNvbGxlY3Rpb24taW1hZ2Utd3JhcHBlciBweS0yXCIgc3R5bGU9XCJ3aWR0aDogMTAwJTsgbWluLWhlaWdodDogMTAwcHg7XCI+XG4gICAgICAgIDxhIGhyZWY9JHtpbWFnZS5pbWFnZVRhcmdldH1cbiAgICAgICAgICA+PGltZyBjbGFzcz1cInctMTAwXCIgc3JjPSR7aW1hZ2UuaW1hZ2VVcmx9IGFsdD0ke2ltYWdlLmltYWdlVGV4dH1cbiAgICAgICAgLz48L2E+XG4gICAgICA8L2Rpdj48L2Rpdj5cbiAgICBgXG4gICAgKX1cbiAgPC9kaXY+YFxuKTtcblxuZXhwb3J0IGRlZmF1bHQgU2lkZWJhclRvcEltYWdlcztcbiIsICJpbXBvcnQgeyBodG1sIH0gZnJvbSAnQGFwb2xsby1lbGVtZW50cy9oYXVudGVkJztcbmltcG9ydCB7IHVzZVBhZ2VDb250ZXh0IH0gZnJvbSAnLi4vLi4vc2hhcmVkL2NvbnRleHQnO1xuaW1wb3J0IFNpZGViYXJDaGVja2JveCBmcm9tICcuL1NpZGViYXJDaGVja2JveCc7XG5pbXBvcnQgU2lkZWJhck5lc3RlZEZpbHRlciBmcm9tICcuL1NpZGViYXJOZXN0ZWRGaWx0ZXInO1xuaW1wb3J0IFNpZGViYXJSYW5nZVNsaWRlciBmcm9tICcuL1NpZGViYXJSYW5nZVNsaWRlcic7XG5pbXBvcnQgU2lkZWJhclNlYXJjaElucHV0IGZyb20gJy4vU2lkZWJhclNlYXJjaElucHV0JztcbmltcG9ydCBTaWRlYmFyU2ltcGxlRmlsdGVyIGZyb20gJy4vU2lkZWJhclNpbXBsZUZJbHRlcic7XG5pbXBvcnQgU2lkZWJhclRvcEltYWdlcyBmcm9tICcuL1NpZGViYXJUb3BJbWFnZXMnO1xuXG5mdW5jdGlvbiBQcm9kdWN0VHlwZVNpZGViYXIoKSB7XG4gIGNvbnN0IHtcbiAgICBzdGF0ZSxcbiAgICBkaXNwYXRjaCxcbiAgICBhcnJheU9mRmlsdGVycyxcbiAgICBjb2xsZWN0aW9uSW1hZ2VzLFxuICB9ID0gdXNlUGFnZUNvbnRleHQoKTtcbiAgLy8gY29uc29sZS5sb2coJ3N0YXRlJywgc3RhdGUpO1xuICBjb25zdCBoYW5kbGVTZWFyY2hTdHJpbmdDaGFuZ2VkID0gKGZpbHRlciwgZSkgPT4ge1xuICAgIGRpc3BhdGNoKHtcbiAgICAgIHR5cGU6IGZpbHRlci5hY3Rpb25UeXBlLFxuICAgICAgcGF5bG9hZDogZS50YXJnZXQudmFsdWUsXG4gICAgfSk7XG4gIH07XG4gIGNvbnN0IGhhbmRsZVNlbGVjdGVkT3B0aW9uc0NoYW5nZWQgPSAob3B0aW9uLCBmaWx0ZXIsIGUpID0+IHtcbiAgICBjb25zdCBpbnB1dCA9IGUudGFyZ2V0O1xuICAgIGlmIChpbnB1dC5jaGVja2VkKSB7XG4gICAgICBkaXNwYXRjaCh7XG4gICAgICAgIHR5cGU6IGZpbHRlci5hY3Rpb25UeXBlLFxuICAgICAgICBwYXlsb2FkOiBbLi4uc3RhdGVbZmlsdGVyLnN0YXRlS2V5XSwgb3B0aW9uXSxcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBkaXNwYXRjaCh7XG4gICAgICAgIHR5cGU6IGZpbHRlci5hY3Rpb25UeXBlLFxuICAgICAgICBwYXlsb2FkOiBzdGF0ZVtmaWx0ZXIuc3RhdGVLZXldLmZpbHRlcigobykgPT4gbyAhPT0gb3B0aW9uKSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbiAgY29uc3QgaGFuZGxlRmlyc3RMZXZlbFNlbGVjdGVkT3B0aW9uc0NoYW5nZWQgPSAoXG4gICAgZmlyc3RMZXZlbE9wdGlvbixcbiAgICBmaWx0ZXIsXG4gICAgZVxuICApID0+IHtcbiAgICBjb25zdCBmaXJzdExldmVsSW5wdXQgPSBlLnRhcmdldDtcbiAgICBpZiAoZmlyc3RMZXZlbElucHV0LmNoZWNrZWQpIHtcbiAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgdHlwZTogZmlsdGVyLmFjdGlvblR5cGUsXG4gICAgICAgIHBheWxvYWQ6IFsuLi5zdGF0ZVtmaWx0ZXIuc3RhdGVLZXldLCBbZmlyc3RMZXZlbE9wdGlvbiwgW11dXSxcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBkaXNwYXRjaCh7XG4gICAgICAgIHR5cGU6IGZpbHRlci5hY3Rpb25UeXBlLFxuICAgICAgICBwYXlsb2FkOiBzdGF0ZVtmaWx0ZXIuc3RhdGVLZXldLmZpbHRlcihcbiAgICAgICAgICAoW2ZPcHRpb25dKSA9PiBmT3B0aW9uICE9PSBmaXJzdExldmVsT3B0aW9uXG4gICAgICAgICksXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IHNlY29uZExldmVsSW5wdXRzID0gZmlyc3RMZXZlbElucHV0LnBhcmVudE5vZGUucXVlcnlTZWxlY3RvckFsbChcbiAgICAgICAgJ3VsIGxpIGlucHV0J1xuICAgICAgKTtcbiAgICAgIC8vIGNvbnNvbGUubG9nKCdzZWNvbmRMZXZlbElucHV0cycsIHNlY29uZExldmVsSW5wdXRzKTtcbiAgICAgIHNlY29uZExldmVsSW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnblxuICAgICAgICBpbnB1dC5jaGVja2VkID0gZmFsc2U7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG4gIGNvbnN0IGhhbmRsZVNlY29uZExldmVsU2VsZWN0ZWRPcHRpb25zQ2hhbmdlZCA9IChcbiAgICBmaXJzdExldmVsT3B0aW9uLFxuICAgIHNlY29uZExldmVsT3B0aW9uLFxuICAgIGZpbHRlcixcbiAgICBlXG4gICkgPT4ge1xuICAgIC8vIGNvbnNvbGUubG9nKGZpcnN0TGV2ZWxPcHRpb24sIHNlY29uZExldmVsT3B0aW9uLCBmaWx0ZXIsIGUpO1xuICAgIGNvbnN0IHNlY29uZExldmVsSW5wdXQgPSBlLnRhcmdldDtcbiAgICBpZiAoc2Vjb25kTGV2ZWxJbnB1dC5jaGVja2VkKSB7XG4gICAgICBkaXNwYXRjaCh7XG4gICAgICAgIHR5cGU6IGZpbHRlci5hY3Rpb25UeXBlLFxuICAgICAgICBwYXlsb2FkOiBzdGF0ZVtmaWx0ZXIuc3RhdGVLZXldLm1hcCgoW2ZPcHRpb24sIHNPcHRpb25zXSkgPT4ge1xuICAgICAgICAgIGlmIChmT3B0aW9uID09PSBmaXJzdExldmVsT3B0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gW2ZPcHRpb24sIFsuLi5zT3B0aW9ucywgc2Vjb25kTGV2ZWxPcHRpb25dXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIFtmT3B0aW9uLCBzT3B0aW9uc107XG4gICAgICAgIH0pLFxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgdHlwZTogZmlsdGVyLmFjdGlvblR5cGUsXG4gICAgICAgIHBheWxvYWQ6IHN0YXRlW2ZpbHRlci5zdGF0ZUtleV0ubWFwKChbZk9wdGlvbiwgc09wdGlvbnNdKSA9PiB7XG4gICAgICAgICAgaWYgKGZPcHRpb24gPT09IGZpcnN0TGV2ZWxPcHRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgIGZPcHRpb24sXG4gICAgICAgICAgICAgIHNPcHRpb25zLmZpbHRlcigoc09wdGlvbikgPT4gc09wdGlvbiAhPT0gc2Vjb25kTGV2ZWxPcHRpb24pLFxuICAgICAgICAgICAgXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIFtmT3B0aW9uLCBzT3B0aW9uc107XG4gICAgICAgIH0pLFxuICAgICAgfSk7XG4gICAgfVxuICB9O1xuICBjb25zdCBoYW5kbGVWYWx1ZVVwZGF0ZWQgPSAoZmlsdGVyLCBlKSA9PiB7XG4gICAgZGlzcGF0Y2goe1xuICAgICAgdHlwZTogZmlsdGVyLmFjdGlvblR5cGUsXG4gICAgICBwYXlsb2FkOiBbZS50YXJnZXQudmFsdWVNaW4sIGUudGFyZ2V0LnZhbHVlTWF4XSxcbiAgICB9KTtcbiAgfTtcbiAgY29uc3QgaGFuZGxlQ2hlY2tib3hJbnB1dENoYW5nZWQgPSAoZmlsdGVyLCBlKSA9PiB7XG4gICAgZGlzcGF0Y2goe1xuICAgICAgdHlwZTogZmlsdGVyLmFjdGlvblR5cGUsXG4gICAgICBwYXlsb2FkOiBlLnRhcmdldC5jaGVja2VkLFxuICAgIH0pO1xuICB9O1xuICByZXR1cm4gaHRtbGA8ZGl2IGNsYXNzPVwiY29sbF9zaWRlYmFyXCI+XG4gICAgJHtTaWRlYmFyVG9wSW1hZ2VzKHsgY29sbGVjdGlvbkltYWdlcyB9KX1cbiAgICAke2FycmF5T2ZGaWx0ZXJzLmZpbmQoKGZpbHRlcikgPT4gZmlsdGVyLnR5cGUgPT09ICdTZWFyY2hJbnB1dCcpXG4gICAgICA/IGh0bWxgXG4gICAgICAgICAgJHtTaWRlYmFyU2VhcmNoSW5wdXQoe1xuICAgICAgICAgICAgc3RhdGUsXG4gICAgICAgICAgICBmaWx0ZXI6IGFycmF5T2ZGaWx0ZXJzLmZpbmQoXG4gICAgICAgICAgICAgIChmaWx0ZXIpID0+IGZpbHRlci50eXBlID09PSAnU2VhcmNoSW5wdXQnXG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgaGFuZGxlU2VhcmNoU3RyaW5nQ2hhbmdlZCxcbiAgICAgICAgICB9KX1cbiAgICAgICAgYFxuICAgICAgOiBudWxsfVxuICAgIDxkaXYgY2xhc3M9XCJjb2xsZWN0aW9uLWZpbHRlci1ibG9jayBjdXN0b21fZmlsdGVyIG10LTRcIj5cbiAgICAgICR7YXJyYXlPZkZpbHRlcnMubWFwKChmaWx0ZXIpID0+IHtcbiAgICAgICAgc3dpdGNoIChmaWx0ZXIudHlwZSkge1xuICAgICAgICAgIGNhc2UgJ1NpbXBsZUZpbHRlcic6IHtcbiAgICAgICAgICAgIHJldHVybiBodG1sYCR7U2lkZWJhclNpbXBsZUZpbHRlcih7XG4gICAgICAgICAgICAgIHN0YXRlLFxuICAgICAgICAgICAgICBmaWx0ZXIsXG4gICAgICAgICAgICAgIGhhbmRsZVNlbGVjdGVkT3B0aW9uc0NoYW5nZWQsXG4gICAgICAgICAgICB9KX1gO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjYXNlICdDaGVja2JveCc6IHtcbiAgICAgICAgICAgIHJldHVybiBodG1sYCR7U2lkZWJhckNoZWNrYm94KHtcbiAgICAgICAgICAgICAgc3RhdGUsXG4gICAgICAgICAgICAgIGZpbHRlcixcbiAgICAgICAgICAgICAgaGFuZGxlQ2hlY2tib3hJbnB1dENoYW5nZWQsXG4gICAgICAgICAgICB9KX1gO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjYXNlICdOZXN0ZWRGaWx0ZXInOiB7XG4gICAgICAgICAgICByZXR1cm4gaHRtbGAke1NpZGViYXJOZXN0ZWRGaWx0ZXIoe1xuICAgICAgICAgICAgICBzdGF0ZSxcbiAgICAgICAgICAgICAgZmlsdGVyLFxuICAgICAgICAgICAgICBoYW5kbGVGaXJzdExldmVsU2VsZWN0ZWRPcHRpb25zQ2hhbmdlZCxcbiAgICAgICAgICAgICAgaGFuZGxlU2Vjb25kTGV2ZWxTZWxlY3RlZE9wdGlvbnNDaGFuZ2VkLFxuICAgICAgICAgICAgfSl9YDtcbiAgICAgICAgICB9XG4gICAgICAgICAgY2FzZSAnUmFuZ2VTbGlkZXInOiB7XG4gICAgICAgICAgICByZXR1cm4gaHRtbGAke1NpZGViYXJSYW5nZVNsaWRlcih7XG4gICAgICAgICAgICAgIHN0YXRlLFxuICAgICAgICAgICAgICBmaWx0ZXIsXG4gICAgICAgICAgICAgIGhhbmRsZVZhbHVlVXBkYXRlZCxcbiAgICAgICAgICAgIH0pfWA7XG4gICAgICAgICAgfVxuICAgICAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSl9XG4gICAgPC9kaXY+XG4gIDwvZGl2PmA7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgdGFnTmFtZTogJ3Byb2R1Y3QtdHlwZS1zaWRlYmFyJyxcbiAgcmVuZGVyZXI6IFByb2R1Y3RUeXBlU2lkZWJhcixcbiAgb3B0aW9uczoge1xuICAgIG9ic2VydmVkQXR0cmlidXRlczogW10sXG4gICAgdXNlU2hhZG93RE9NOiBmYWxzZSxcbiAgfSxcbn07XG5cbi8vIDxkaXYgY2xhc3M9XCJjb2xsZWN0aW9uLWZpbHRlciBjb2wtc20tM1wiPlxuLy8gICAgIDxkaXYgY2xhc3M9XCJjb2xsX3NpZGViYXJcIj5cbi8vICAgICAgIDxjb2xsZWN0aW9uLXNpZGViYXItdG9wLWltYWdlcz48L2NvbGxlY3Rpb24tc2lkZWJhci10b3AtaW1hZ2VzPlxuLy8gICAgICAgPGNvbGxlY3Rpb24tc2lkZWJhci1zZWFyY2gtaW5wdXQ+PC9jb2xsZWN0aW9uLXNpZGViYXItc2VhcmNoLWlucHV0PlxuLy8gICAgICAgJHtGaWx0ZXJGb3JUaGVQcm9kdWN0VHlwZSgpfVxuLy8gICAgIDwvZGl2PlxuLy8gICA8L2Rpdj5cbiIsICJpbXBvcnQgeyBodG1sLCB1c2VSZWYgfSBmcm9tICdAYXBvbGxvLWVsZW1lbnRzL2hhdW50ZWQnO1xuaW1wb3J0IHsgdXNlUGFnZUNvbnRleHQgfSBmcm9tICcuLi8uLi9zaGFyZWQvY29udGV4dCc7XG5pbXBvcnQgUGFnaW5hdGlvbiBmcm9tICcuLi9jb21tb24vUGFnaW5hdGlvbic7XG5pbXBvcnQgVGl0bGVCYW5uZXIgZnJvbSAnLi4vY29tbW9uL1RpdGxlQmFubmVyJztcbmltcG9ydCBUb3BDb250cm9sbGVycyBmcm9tICcuLi9jb21tb24vVG9wQ29udHJvbGxlcnMnO1xuaW1wb3J0IFByb2R1Y3RzIGZyb20gJy4uL2NvbW1vbi9Qcm9kdWN0cyc7XG5cbmZ1bmN0aW9uIFByb2R1Y3RUeXBlTWFpbkNvbnRlbnQoKSB7XG4gIGNvbnN0IHtcbiAgICBjb2xsZWN0aW9uVGl0bGUsXG4gICAgZW1wdHlDb2xsZWN0aW9uSW1hZ2UsXG4gICAgZ2V0RmlsdGVyZWRTb3J0ZWRQcm9kdWN0cyxcbiAgICBnZXRGaWx0ZXJlZFNvcnRlZFByb2R1Y3RzT2ZDdXJyZW50UGFnZSxcbiAgICBnZXRQYWdlQ291bnQsXG4gICAgZ2V0RGlzcGxheWVkUGFnZU51bWJlcnMsXG4gICAgcHJvZHVjdHNPZkZpcnN0UGFnZSxcbiAgICBzdGF0ZSxcbiAgICBkaXNwYXRjaCxcbiAgfSA9IHVzZVBhZ2VDb250ZXh0KCk7XG4gIGNvbnN0IHtcbiAgICBmZXRjaElzRmluaXNoZWQsXG4gICAgdmlld01vZGUsXG4gICAgc29ydFZhbHVlLFxuICAgIHByb2R1Y3RzUGVyUGFnZSxcbiAgICBwYWdlTnVtYmVyLFxuICB9ID0gc3RhdGU7XG4gIGNvbnN0IHNlYXJjaGVkUHJvZHVjdHMgPSBnZXRGaWx0ZXJlZFNvcnRlZFByb2R1Y3RzKCk7XG4gIGNvbnN0IHByb2R1Y3RzU2l6ZSA9IHNlYXJjaGVkUHJvZHVjdHMubGVuZ3RoO1xuICBsZXQgcHJvZHVjdHNPZkN1cnJlbnRQYWdlID0gW107XG4gIGlmICghZmV0Y2hJc0ZpbmlzaGVkKSB7XG4gICAgcHJvZHVjdHNPZkN1cnJlbnRQYWdlID0gcHJvZHVjdHNPZkZpcnN0UGFnZSA/PyBbXTtcbiAgfSBlbHNlIHtcbiAgICBwcm9kdWN0c09mQ3VycmVudFBhZ2UgPSBnZXRGaWx0ZXJlZFNvcnRlZFByb2R1Y3RzT2ZDdXJyZW50UGFnZSgpO1xuICB9XG5cbiAgY29uc3QgcGFnZUNvdW50ID0gZ2V0UGFnZUNvdW50KCk7XG4gIGNvbnN0IGRpc3BsYXllZFBhZ2VOdW1iZXJzID0gZ2V0RGlzcGxheWVkUGFnZU51bWJlcnMoKTtcbiAgY29uc3QgdGhpc1JlZiA9IHVzZVJlZih0aGlzKTtcbiAgY29uc3QgaGFuZGxlVmlld01vZGVJY29uQ2xpY2tlZCA9IChuZXdWaWV3TW9kZSkgPT4ge1xuICAgIGRpc3BhdGNoKHsgdHlwZTogJ2NoYW5nZVZpZXdNb2RlJywgcGF5bG9hZDogbmV3Vmlld01vZGUgfSk7XG4gIH07XG4gIGNvbnN0IGhhbmRsZVByb2R1Y3RzUGVyUGFnZUNoYW5nZWQgPSAoZSkgPT4ge1xuICAgIGRpc3BhdGNoKHtcbiAgICAgIHR5cGU6ICdjaGFuZ2VQcm9kdWN0c1BlclBhZ2UnLFxuICAgICAgcGF5bG9hZDogTnVtYmVyKGUudGFyZ2V0LnZhbHVlKSxcbiAgICB9KTtcbiAgfTtcbiAgY29uc3QgaGFuZGxlU29ydFZhbHVlQ2hhbmdlZCA9IChlKSA9PiB7XG4gICAgZGlzcGF0Y2goe1xuICAgICAgdHlwZTogJ2NoYW5nZVNvcnRWYWx1ZScsXG4gICAgICBwYXlsb2FkOiBlLnRhcmdldC52YWx1ZSxcbiAgICB9KTtcbiAgfTtcbiAgY29uc3QgaGFuZGxlUGFnZUxpbmtDbGlja2VkID0gKG51bWJlcikgPT4ge1xuICAgIGlmIChOdW1iZXIuaXNOYU4oTnVtYmVyKG51bWJlcikpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGRpc3BhdGNoKHsgdHlwZTogJ2NoYW5nZVBhZ2VOdW1iZXInLCBwYXlsb2FkOiBudW1iZXIgfSk7XG4gIH07XG4gIC8vIGNvbnNvbGUubG9nKCdjb2xsZWN0aW9uVGl0bGUnLCBjb2xsZWN0aW9uVGl0bGUpO1xuICByZXR1cm4gaHRtbGAke1RpdGxlQmFubmVyKHtcbiAgICB0aXRsZTogY29sbGVjdGlvblRpdGxlLFxuICB9KX0ke1RvcENvbnRyb2xsZXJzKHtcbiAgICBmZXRjaElzRmluaXNoZWQsXG4gICAgcHJvZHVjdHNTaXplLFxuICAgIHZpZXdNb2RlLFxuICAgIHByb2R1Y3RzUGVyUGFnZSxcbiAgICBzb3J0VmFsdWUsXG4gICAgaGFuZGxlVmlld01vZGVJY29uQ2xpY2tlZCxcbiAgICBoYW5kbGVQcm9kdWN0c1BlclBhZ2VDaGFuZ2VkLFxuICAgIGhhbmRsZVNvcnRWYWx1ZUNoYW5nZWQsXG4gIH0pfSR7UHJvZHVjdHMoe1xuICAgIG1haW5Db250ZW50RWxlbWVudDogdGhpc1JlZi5jdXJyZW50LFxuICAgIHByb2R1Y3RzT2ZDdXJyZW50UGFnZSxcbiAgICB2aWV3TW9kZSxcbiAgICBlbXB0eUNvbGxlY3Rpb25JbWFnZSxcbiAgfSl9JHtQYWdpbmF0aW9uKHtcbiAgICBmZXRjaElzRmluaXNoZWQsXG4gICAgcGFnZU51bWJlcixcbiAgICBkaXNwbGF5ZWRQYWdlTnVtYmVycyxcbiAgICBwYWdlQ291bnQsXG4gICAgaGFuZGxlUGFnZUxpbmtDbGlja2VkLFxuICB9KX1gO1xufVxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIHRhZ05hbWU6ICdwcm9kdWN0LXR5cGUtbWFpbi1jb250ZW50JyxcbiAgcmVuZGVyZXI6IFByb2R1Y3RUeXBlTWFpbkNvbnRlbnQsXG4gIG9wdGlvbnM6IHtcbiAgICBvYnNlcnZlZEF0dHJpYnV0ZXM6IFtdLFxuICAgIHVzZVNoYWRvd0RPTTogZmFsc2UsXG4gIH0sXG59O1xuIl0sCiAgIm1hcHBpbmdzIjogIm1UQUNBLE1BQW9CLE9DQXBCLE1BQW9CLE9BRWQsRUFBa0IsRUFDdEIsQ0FBQyxDQUFFLFFBQU8sU0FBUSxnQ0FBaUMsQ0FDakQsR0FBTSxDQUFFLG1CQUFvQixFQUN0QixDQUFFLE1BQU8sRUFBYSxZQUFhLEVBQ25DLEVBQVUsRUFBTSxHQUN0QixNQUFPO0FBQUE7QUFBQSwyQ0FFZ0M7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSx3QkFPbkIsQUFBQyxHQUFNLEVBQTJCLEVBQVE7QUFBQSxtQkFDL0MsY0FBUSxFQUFVLENBQUUsTUFBTztBQUFBLHlCQUNyQjtBQUFBLDBCQUNDLENBQUM7QUFBQTtBQUFBO0FBQUE7QUFBQSxvQkFJUCxjQUFRLEVBQVUsQ0FBRSxNQUFPO0FBQUEsaUJBQzlCO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxjQVNWLEVBQVEsRUNqQ2YsTUFBb0IsT0FFZCxFQUFzQixFQUMxQixDQUFDLENBQ0MsUUFDQSxTQUNBLHlDQUNBLDZDQUNJLENBQ0osR0FBTSxDQUFFLGtCQUFpQixnQkFBaUIs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
